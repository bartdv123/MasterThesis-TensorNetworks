using CairoMakie
using LaTeXStrings

# 4x4 qubit grid at depth 4

#chi = 20 !
local_error_list20 = [-2.220446049250313e-16, 1.1102230246251565e-16, -2.220446049250313e-16, 2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 2.220446049250313e-16, 3.3306690738754696e-16, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, -2.220446049250313e-16, 0.0, 4.440892098500626e-16, -2.220446049250313e-16, -2.220446049250313e-16, 5.551115123125783e-16, 3.3306690738754696e-16, 2.220446049250313e-16, 4.440892098500626e-16, 0.0, 2.220446049250313e-16, 2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.6875000000000002, 0.7499999999999997, 6.661338147750939e-16, -2.220446049250313e-16, 0.535224715195563, 0.12072178409913492, 0.8422952223279158, 0.7879224786923891, 0.08973949445556273, 0.47335053587435494, 0.805888293131211, 0.2683663063840076, 0.035573614487838245, 0.3481428046766558, 0.12756070622736426, 0.22542089318424086, 0.17031807787291453, 0.3992972744374973]
cost_loops20 = 85151296
cost_tree20 = 2202080
global_error20 = 0.9998475962378819


#chi = 32
local_error_list32 = Any[-2.220446049250313e-16, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 2.220446049250313e-16, 2.220446049250313e-16, 1.1102230246251565e-16, 4.440892098500626e-16, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, -2.220446049250313e-16, 6.661338147750939e-16, 1.1102230246251565e-16, 1.1102230246251565e-16, 3.3306690738754696e-16, 3.3306690738754696e-16, 3.3306690738754696e-16, 2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 1.1102230246251565e-16, 1.1102230246251565e-16, 0.0, 2.220446049250313e-16, 6.661338147750939e-16, 0.5000000000000001, 0.7499999999999998, -4.440892098500626e-16, 0.0, 0.4306325813869979, 0.08868774411204672, 0.8038239694093079, 0.8531320417239384, 0.046322370867896145, 0.6187176524935991, 0.7721287578940527, 0.2688187036081654, 0.04709088860937527, 0.4641186042115889, 0.17662784832166256, 0.30332462473657895, 0.17756686764680663, 0.5006443418497027]
cost_tree32 = 4685824
memory_usage = [7175.22265625, 7175.7109375, 7225.39453125, 7225.39453125, 7544.0078125, 7544.0078125, 7497.40625, 7464.13671875, 7478.0546875, 7478.546875, 7509.0, 7480.0546875, 7497.61328125, 7497.61328125, 7485.0859375, 7486.015625, 7517.59375, 7517.59375, 7518.9921875, 7518.9921875, 7527.10546875, 7527.59765625, 7542.94921875, 7542.94921875, 7543.3125, 7543.3125, 7520.328125, 7520.765625, 7525.91015625, 7525.91015625, 7450.12109375, 7450.12109375, 7438.23046875, 7438.23046875, 7431.828125, 7431.828125, 7453.37890625, 7453.37890625, 7459.53515625, 7459.53515625, 7467.12109375, 7467.12109375, 7465.08984375, 7465.08984375, 7466.28515625, 7466.28515625, 7475.90625, 7475.90625, 7479.65234375, 7479.65234375, 7476.08984375, 7476.08984375, 7470.09765625, 7470.09765625, 7459.8515625, 7460.34375, 7463.140625, 7469.75390625, 7478.65234375, 7467.7734375, 7497.7421875, 7500.08984375, 7553.4296875, 7505.84375, 7573.2890625, 7533.6171875, 7512.375, 7531.2265625, 7526.359375, 7532.95703125, 7794.08984375, 7444.74609375, 7423.05859375, 7449.73046875, 9005.125, 7478.89453125, 7527.6796875, 7287.75, 7117.94921875, 7111.57421875, 7438.59375, 7134.75390625, 7617.16015625, 7505.4453125, 7235.73046875, 7202.21875, 7211.0234375, 7225.1328125, 8711.49609375, 7279.7578125, 7317.359375, 7242.16796875, 7408.375, 7222.76171875, 8497.984375, 7254.91796875, 8451.296875, 7258.40625, 7319.12890625, 7319.12890625, 7330.85546875, 7331.1015625, 7275.359375, 7275.359375, 7299.2421875, 7281.31640625, 7284.9609375, 7285.453125, 7289.3203125, 7274.26953125, 7283.06640625, 7283.06640625, 7286.5390625, 7286.5390625, 7307.4765625, 7307.96875, 7315.9453125, 7315.9453125, 7322.76171875, 7323.25390625, 6010.09765625, 6010.09765625, 6035.49609375, 6035.49609375, 6036.9609375, 6037.453125, 6027.17578125, 6027.17578125, 6014.859375, 6015.3515625, 5958.3203125, 5958.3203125, 5964.47265625, 5964.96484375, 5935.4375, 5935.9296875, 5946.38671875, 5947.8515625, 5911.47265625, 5911.47265625, 5894.421875, 5895.8984375, 5899.7734375, 5899.7734375, 5898.88671875, 5898.88671875, 5892.49609375, 5892.49609375, 5913.4375, 5913.9296875, 5925.2578125, 5925.2578125, 5886.609375, 5886.609375, 5861.11328125, 5864.03515625, 5863.3046875, 5858.09375, 5861.65625, 5853.97265625, 5846.01953125, 5843.1875, 5910.66015625, 5851.32421875, 5844.30078125, 5827.0234375, 5811.34375, 5813.76171875, 6176.921875, 5815.20703125, 5822.703125, 5816.2421875, 8907.2734375, 5982.7734375, 6618.546875, 6084.421875, 5762.66796875, 5596.98046875, 6667.32421875, 5789.09765625, 8393.39453125, 5737.1171875, 5737.1171875, 5749.6484375, 5749.6484375, 5749.375, 5749.375, 5759.4921875, 5724.46484375, 5730.23828125, 5730.73046875, 5739.7890625, 5729.08984375, 5760.73828125, 5760.73828125, 5740.12890625, 5740.12890625, 5746.9453125, 5749.40625, 5774.47265625, 5774.45703125, 5766.96875, 5766.96875, 5777.6953125, 5778.1875, 5773.13671875, 5773.13671875, 5780.484375, 5782.9453125, 5783.94140625, 5783.94140625, 5777.87109375, 5777.87109375, 5764.03125, 5764.03125, 5776.2265625, 5776.2265625, 5772.9921875, 5772.9921875, 5758.0703125, 5757.0546875, 5779.20703125, 5779.20703125, 5779.61328125, 5779.61328125, 5752.21484375, 5752.21484375, 5758.1796875, 5758.671875, 5768.59375, 5768.59375, 5763.34765625, 5763.34765625, 5756.4453125, 5756.4453125, 5750.4765625, 5750.4765625, 5759.703125, 5744.0625, 5763.75, 5763.75, 5764.4609375, 5767.41015625, 5800.1640625, 5724.3515625, 5790.0859375, 5677.92578125, 5679.0625, 5704.49609375, 5713.2265625, 5713.0, 6007.51171875, 5654.5546875, 5656.7578125, 5707.140625, 8822.75, 5783.5078125, 6600.5390625, 6147.421875, 5818.9765625, 5645.80078125, 6796.51171875, 5836.9921875, 8512.859375, 7687.5859375, 5977.55859375, 5672.671875, 5628.23046875, 5629.01953125, 11768.078125, 5631.0234375, 5852.71484375, 5707.01953125, 6978.10546875, 6020.04296875, 5661.390625, 5647.453125, 8891.23046875, 6006.16796875]
global_error32 = 0.99838528121563
time_loops32 = 0.956652117
time_trees32 = 0.0104164

#chi = 8
globalerror8 = 0.9999759038883081
treecost8 = 642560
loopcost8 = 85151296
local_error_list8 = Any[-2.220446049250313e-16, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 3.3306690738754696e-16, -2.220446049250313e-16, 2.220446049250313e-16, 1.1102230246251565e-16, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 3.3306690738754696e-16, 1.1102230246251565e-16, 2.220446049250313e-16, -2.220446049250313e-16, 4.440892098500626e-16, 0.0, 1.1102230246251565e-16, 2.220446049250313e-16, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, -4.440892098500626e-16, 0.5000000000000002, 0.4845277480567033, 0.5000000000000002, 0.6577683559488057, 0.7500000007759969, 0.50702997907098, 0.26859076051999564, 0.5529474335234645, 0.03349309759451691, 0.5517047963501788, 0.7257284173120842, 0.41654580514660067, 0.5154975514943418, 0.7993488513928524, 0.18723709002033828, 0.02121722178612706, 0.32715872273179625, 0.07273248740474214, 0.17950777509379134, 0.24639478292952055, 0.3707912659985645]

#chi = 12
global_error12 = 0.9998570250974754
tree_cost12 = 1067040
local_error_list = Any[0.0, 1.1102230246251565e-16, -2.220446049250313e-16, 0.0, 1.1102230246251565e-16, -2.220446049250313e-16, 0.0, 4.440892098500626e-16, 1.1102230246251565e-16, -2.220446049250313e-16, 1.1102230246251565e-16, 0.0, -2.220446049250313e-16, -2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, 0.0, -2.220446049250313e-16, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 2.220446049250313e-16, 0.0, -2.220446049250313e-16, 1.1102230246251565e-16, 1.1102230246251565e-16, -2.220446049250313e-16, 0.2500000000000002, 0.16678877206329823, 0.2499999999999999, 0.7030100044917542, 0.7500022682973515, 0.2632678037664783, 0.20548348114837434, 0.4916417132062073, 0.12640403573044035, 0.677809104828945, 0.7309313151434367, 0.23471683193028536, 0.6924959790987484, 0.7070621954293825, 0.15967463061194598, 0.0130688803858523, 0.4310860477247266, 0.1420681808564358, 0.3154650558709904, 0.162087234978204, 0.32532183412513993]

loopcost12 = 85151296

